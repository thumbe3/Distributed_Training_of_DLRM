
clgpu001:37881:37984 [0] misc/ibvwrap.cc:63 NCCL WARN Failed to open libibverbs.so[.1]
NCCL version 2.4.8+cuda9.2
Using 2 GPU(s)...
Sparse features= 9, Dense features= 24
Sparse features= 9, Dense features= 24
time/loss/accuracy (if enabled):
Finished training it 100/170 of epoch 0 and time taken 4.921202898025513, 42.73 ms/it, loss 0.669656, accuracy 59.527 %
DLRM_wrap_time 26.88, loss_fn_time 0.20, Backward_pass_time  9.42, Average_Grad_time 5.04, Optimizer_step_time 1.01
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 0, loss 0.677808, accuracy 58.319 %, best 58.319 %
Finished training it 170/170 of epoch 0 and time taken 7.185019493103027, 22.83 ms/it, loss 0.652269, accuracy 61.433 %
DLRM_wrap_time 7.71, loss_fn_time 0.21, Backward_pass_time  9.03, Average_Grad_time 4.68, Optimizer_step_time 1.01
Finished epoch 0
Finished training it 100/170 of epoch 1 and time taken 10.105981349945068, 22.91 ms/it, loss 0.663359, accuracy 59.955 %
DLRM_wrap_time 7.70, loss_fn_time 0.22, Backward_pass_time  9.12, Average_Grad_time 4.68, Optimizer_step_time 1.00
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 1, loss 0.609596, accuracy 66.459 %, best 66.459 %
Finished training it 170/170 of epoch 1 and time taken 12.410188436508179, 23.12 ms/it, loss 0.640227, accuracy 62.617 %
DLRM_wrap_time 7.92, loss_fn_time 0.21, Backward_pass_time  9.10, Average_Grad_time 4.66, Optimizer_step_time 1.02
Finished epoch 1
Finished training it 100/170 of epoch 2 and time taken 15.340934991836548, 23.13 ms/it, loss 0.620257, accuracy 65.664 %
DLRM_wrap_time 8.07, loss_fn_time 0.21, Backward_pass_time  9.06, Average_Grad_time 4.57, Optimizer_step_time 1.02
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 2, loss 0.532854, accuracy 73.051 %, best 73.051 %
Finished training it 170/170 of epoch 2 and time taken 17.663103580474854, 23.34 ms/it, loss 0.585531, accuracy 67.372 %
DLRM_wrap_time 8.15, loss_fn_time 0.21, Backward_pass_time  9.10, Average_Grad_time 4.65, Optimizer_step_time 1.03
Finished epoch 2
Finished training it 100/170 of epoch 3 and time taken 20.632347345352173, 23.17 ms/it, loss 0.580367, accuracy 68.992 %
DLRM_wrap_time 8.13, loss_fn_time 0.23, Backward_pass_time  8.98, Average_Grad_time 4.59, Optimizer_step_time 1.04
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 3, loss 0.545650, accuracy 69.302 %, best 73.051 %
Finished training it 170/170 of epoch 3 and time taken 22.90367555618286, 22.84 ms/it, loss 0.558082, accuracy 70.774 %
DLRM_wrap_time 8.04, loss_fn_time 0.20, Backward_pass_time  8.73, Average_Grad_time 4.62, Optimizer_step_time 1.05
Finished epoch 3
Finished training it 100/170 of epoch 4 and time taken 25.828677892684937, 23.04 ms/it, loss 0.537826, accuracy 72.121 %
DLRM_wrap_time 8.05, loss_fn_time 0.21, Backward_pass_time  8.95, Average_Grad_time 4.61, Optimizer_step_time 1.03
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 4, loss 0.477090, accuracy 78.591 %, best 78.591 %
Finished training it 170/170 of epoch 4 and time taken 28.09644913673401, 22.90 ms/it, loss 0.542993, accuracy 71.722 %
DLRM_wrap_time 8.00, loss_fn_time 0.20, Backward_pass_time  8.85, Average_Grad_time 4.62, Optimizer_step_time 1.03
Finished epoch 4
Finished training it 100/170 of epoch 5 and time taken 30.792633771896362, 20.93 ms/it, loss 0.522043, accuracy 73.969 %
DLRM_wrap_time 8.01, loss_fn_time 0.19, Backward_pass_time  6.95, Average_Grad_time 4.57, Optimizer_step_time 1.01
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 5, loss 0.455849, accuracy 79.556 %, best 79.556 %
Finished training it 170/170 of epoch 5 and time taken 32.86786103248596, 20.58 ms/it, loss 0.504405, accuracy 73.988 %
DLRM_wrap_time 8.01, loss_fn_time 0.19, Backward_pass_time  6.61, Average_Grad_time 4.58, Optimizer_step_time 1.00
Finished epoch 5
Finished training it 100/170 of epoch 6 and time taken 35.51894569396973, 20.53 ms/it, loss 0.489022, accuracy 76.098 %
DLRM_wrap_time 8.06, loss_fn_time 0.20, Backward_pass_time  6.53, Average_Grad_time 4.55, Optimizer_step_time 1.00
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 6, loss 0.423335, accuracy 82.109 %, best 82.109 %
Finished training it 170/170 of epoch 6 and time taken 37.593515396118164, 20.52 ms/it, loss 0.481361, accuracy 76.867 %
DLRM_wrap_time 8.03, loss_fn_time 0.19, Backward_pass_time  6.59, Average_Grad_time 4.54, Optimizer_step_time 0.99
Finished epoch 6
Finished training it 100/170 of epoch 7 and time taken 40.23626923561096, 20.45 ms/it, loss 0.458004, accuracy 78.299 %
DLRM_wrap_time 8.01, loss_fn_time 0.19, Backward_pass_time  6.50, Average_Grad_time 4.56, Optimizer_step_time 1.00
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 7, loss 0.451741, accuracy 75.874 %, best 82.109 %
Finished training it 170/170 of epoch 7 and time taken 42.3025016784668, 20.39 ms/it, loss 0.475807, accuracy 77.543 %
DLRM_wrap_time 7.96, loss_fn_time 0.19, Backward_pass_time  6.53, Average_Grad_time 4.53, Optimizer_step_time 1.00
Finished epoch 7
Finished training it 100/170 of epoch 8 and time taken 44.94451403617859, 20.47 ms/it, loss 0.460237, accuracy 78.039 %
DLRM_wrap_time 8.07, loss_fn_time 0.19, Backward_pass_time  6.47, Average_Grad_time 4.56, Optimizer_step_time 0.99
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 8, loss 0.492705, accuracy 72.644 %, best 82.109 %
Finished training it 170/170 of epoch 8 and time taken 47.02439546585083, 20.54 ms/it, loss 0.477050, accuracy 77.549 %
DLRM_wrap_time 8.08, loss_fn_time 0.19, Backward_pass_time  6.59, Average_Grad_time 4.49, Optimizer_step_time 1.00
Finished epoch 8
Finished training it 100/170 of epoch 9 and time taken 49.67123532295227, 20.56 ms/it, loss 0.447608, accuracy 78.443 %
DLRM_wrap_time 8.05, loss_fn_time 0.19, Backward_pass_time  6.59, Average_Grad_time 4.54, Optimizer_step_time 1.00
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 9, loss 0.376841, accuracy 85.174 %, best 85.174 %
Finished training it 170/170 of epoch 9 and time taken 51.74842143058777, 20.58 ms/it, loss 0.453930, accuracy 78.627 %
DLRM_wrap_time 8.02, loss_fn_time 0.19, Backward_pass_time  6.61, Average_Grad_time 4.58, Optimizer_step_time 1.00
Finished epoch 9
Finished training it 100/170 of epoch 10 and time taken 54.506306886672974, 22.15 ms/it, loss 0.470385, accuracy 77.207 %
DLRM_wrap_time 7.77, loss_fn_time 0.19, Backward_pass_time  6.12, Average_Grad_time 6.94, Optimizer_step_time 0.95
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 10, loss 0.355049, accuracy 86.466 %, best 86.466 %
Finished training it 170/170 of epoch 10 and time taken 56.76128911972046, 23.80 ms/it, loss 0.479067, accuracy 76.898 %
DLRM_wrap_time 7.74, loss_fn_time 0.19, Backward_pass_time  6.12, Average_Grad_time 8.64, Optimizer_step_time 0.93
Finished epoch 10
Finished training it 100/170 of epoch 11 and time taken 59.660563707351685, 23.76 ms/it, loss 0.470910, accuracy 76.855 %
DLRM_wrap_time 7.76, loss_fn_time 0.19, Backward_pass_time  6.08, Average_Grad_time 8.63, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 11, loss 0.364248, accuracy 85.769 %, best 86.466 %
Finished training it 170/170 of epoch 11 and time taken 61.93545579910278, 24.08 ms/it, loss 0.466482, accuracy 77.679 %
DLRM_wrap_time 7.79, loss_fn_time 0.19, Backward_pass_time  6.10, Average_Grad_time 8.90, Optimizer_step_time 0.93
Finished epoch 11
Finished training it 100/170 of epoch 12 and time taken 64.86278057098389, 23.98 ms/it, loss 0.447220, accuracy 78.230 %
DLRM_wrap_time 7.85, loss_fn_time 0.20, Backward_pass_time  6.14, Average_Grad_time 8.69, Optimizer_step_time 0.94
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 12, loss 0.430330, accuracy 78.446 %, best 86.466 %
Finished training it 170/170 of epoch 12 and time taken 67.12637042999268, 23.75 ms/it, loss 0.454475, accuracy 77.731 %
DLRM_wrap_time 7.83, loss_fn_time 0.19, Backward_pass_time  6.10, Average_Grad_time 8.52, Optimizer_step_time 0.93
Finished epoch 12
Finished training it 100/170 of epoch 13 and time taken 70.05118012428284, 24.06 ms/it, loss 0.424702, accuracy 79.324 %
DLRM_wrap_time 7.83, loss_fn_time 0.19, Backward_pass_time  6.08, Average_Grad_time 8.86, Optimizer_step_time 0.93/users/ushmal/.local/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py:101: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn("torch.distributed.reduce_op is deprecated, please use "

Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 13, loss 0.371095, accuracy 84.899 %, best 86.466 %
Finished training it 170/170 of epoch 13 and time taken 72.32459712028503, 23.92 ms/it, loss 0.419866, accuracy 79.877 %
DLRM_wrap_time 7.81, loss_fn_time 0.19, Backward_pass_time  6.16, Average_Grad_time 8.67, Optimizer_step_time 0.92
Finished epoch 13
Finished training it 100/170 of epoch 14 and time taken 75.23914766311646, 23.99 ms/it, loss 0.419854, accuracy 79.799 %
DLRM_wrap_time 7.85, loss_fn_time 0.19, Backward_pass_time  6.07, Average_Grad_time 8.78, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 14, loss 0.454987, accuracy 74.748 %, best 86.466 %
Finished training it 170/170 of epoch 14 and time taken 77.50826382637024, 23.78 ms/it, loss 0.416944, accuracy 80.532 %
DLRM_wrap_time 7.85, loss_fn_time 0.20, Backward_pass_time  6.15, Average_Grad_time 8.48, Optimizer_step_time 0.93
Finished epoch 14
Finished training it 100/170 of epoch 15 and time taken 80.41549181938171, 23.87 ms/it, loss 0.417841, accuracy 80.168 %
DLRM_wrap_time 7.83, loss_fn_time 0.19, Backward_pass_time  6.05, Average_Grad_time 8.69, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 15, loss 0.358718, accuracy 85.312 %, best 86.466 %
Finished training it 170/170 of epoch 15 and time taken 82.68540716171265, 23.94 ms/it, loss 0.407253, accuracy 80.414 %
DLRM_wrap_time 7.87, loss_fn_time 0.20, Backward_pass_time  6.11, Average_Grad_time 8.66, Optimizer_step_time 0.94
Finished epoch 15
Finished training it 100/170 of epoch 16 and time taken 85.60500240325928, 23.95 ms/it, loss 0.407324, accuracy 80.988 %
DLRM_wrap_time 7.78, loss_fn_time 0.19, Backward_pass_time  6.10, Average_Grad_time 8.77, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 16, loss 0.350712, accuracy 84.044 %, best 86.466 %
Finished training it 170/170 of epoch 16 and time taken 87.87901425361633, 24.08 ms/it, loss 0.420542, accuracy 80.881 %
DLRM_wrap_time 7.86, loss_fn_time 0.19, Backward_pass_time  6.11, Average_Grad_time 8.81, Optimizer_step_time 0.92
Finished epoch 16
Finished training it 100/170 of epoch 17 and time taken 90.7955994606018, 23.96 ms/it, loss 0.400399, accuracy 80.701 %
DLRM_wrap_time 7.85, loss_fn_time 0.19, Backward_pass_time  6.06, Average_Grad_time 8.76, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 17, loss 0.390487, accuracy 79.245 %, best 86.466 %
Finished training it 170/170 of epoch 17 and time taken 93.05445981025696, 23.78 ms/it, loss 0.397495, accuracy 82.120 %
DLRM_wrap_time 7.83, loss_fn_time 0.19, Backward_pass_time  6.17, Average_Grad_time 8.48, Optimizer_step_time 0.94
Finished epoch 17
Finished training it 100/170 of epoch 18 and time taken 95.95416927337646, 23.64 ms/it, loss 0.391834, accuracy 81.531 %
DLRM_wrap_time 7.85, loss_fn_time 0.19, Backward_pass_time  6.15, Average_Grad_time 8.34, Optimizer_step_time 0.93
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 18, loss 0.301629, accuracy 88.990 %, best 88.990 %
Finished training it 170/170 of epoch 18 and time taken 98.2165379524231, 23.62 ms/it, loss 0.386026, accuracy 82.012 %
DLRM_wrap_time 7.76, loss_fn_time 0.20, Backward_pass_time  6.22, Average_Grad_time 8.34, Optimizer_step_time 0.92
Finished epoch 18
Finished training it 100/170 of epoch 19 and time taken 101.11708164215088, 23.80 ms/it, loss 0.386077, accuracy 81.887 %
DLRM_wrap_time 7.71, loss_fn_time 0.19, Backward_pass_time  6.09, Average_Grad_time 8.73, Optimizer_step_time 0.91
Starting Test loop
Test loop ended
Testing at - 100/170 of epoch 19, loss 0.325962, accuracy 85.404 %, best 88.990 %
Finished training it 170/170 of epoch 19 and time taken 103.31088066101074, 22.76 ms/it, loss 0.385546, accuracy 81.529 %
DLRM_wrap_time 7.77, loss_fn_time 0.19, Backward_pass_time  6.03, Average_Grad_time 7.69, Optimizer_step_time 0.92
Finished epoch 19
Finished the program
